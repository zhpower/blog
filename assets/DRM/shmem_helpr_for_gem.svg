<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="992" height="2333"><desc>title%20shmem_helper%20for%20gem%0A%0A%0A%3D%3Ddrm_gem_shmem_prime_import_sg_table%3D%3D%0Ashmem_helper%3C-drm_gem%3Adrm_gem_shmem_prime_import_sg_table(%20)%0Arbox%20right%20of%20shmem_helper%3A%5C%2F%5C%2F%E4%B8%8E%E4%B8%8A%E9%9D%A2%3Ccolor%3A%23red%3Edrm_gem_shmem_dumb_create%3C%2Fcolor%3E(%20)%E7%9B%B8%E7%B1%BB%E4%BC%BC%E7%9A%84%E6%93%8D%E4%BD%9C%5Cn%5C%2F%5C%2F%E6%9E%84%E5%BB%BAgem_obj%5Cn%5Cn_drm_gem_shmem_create(%20)%5Cn%5Cn%20%201.if%20driver-%3Egem_create_object%20is%20null%2C%20call%20it%5Cn%20%20%20%20or%20kzalloc(sizeof(shmem_obj))%5Cn%5Cn%20%202.%20gem_obj-%3Efuncs%20%3D%20%26drm_gem_shmem_funcs%5Cn%5Cn%20%203.%20drm_gem_object_init(%20)%5Cn%5Cn%20%204.%20drm_gem_create_mmap_offset()%5Cn%5Cnshmem-%3Esgt%20%3D%20sgt%20%5C%2F%5C%2F%3Ccolor%3A%23red%3Esave%20sgt%3C%2Fcolor%3E%0A%3D%3Ddrm_gem_shmem_object_vmap%3D%3D%0Ashmem_helper%3C-drm_gem%3Adrm_gem_shmem_object_vmap(%20)%0Arbox%20right%20of%20shmem_helper%3Adrm_gem_shmem_vmap(%20)%5Cn%20%20drm_gem_shmem_vmap_locked(%20)%5Cn%20%20%5Cn%20%20%20%20%20%201.%20%3Ccolor%3A%23green%3Edrm_gem_shmem_get_pages%3C%2Fcolor%3E(%20)%20%5C%2F%5C%2F%E8%A7%81%E4%B8%8A%E9%9D%A2%E7%9A%84%E5%AE%9E%E7%8E%B0%5Cn%20%5Cn%20%20%20%20%20%202.%20vmap(%20)%5C%2F%5C%2F%E6%8A%8A%E4%B8%8D%E8%BF%9E%E7%BB%AD%E7%9A%84%E7%89%A9%E7%90%86%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84%E5%88%B0%E4%B8%80%E4%B8%AA%E8%BF%9E%E7%BB%AD%E7%9A%84%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%5Cn%20%5Cn%20%20%20%20%20%203.%20dma_buf_map_set_vaddr(%20)%5C%2F%5C%2F%E5%B0%86dma-buf%20%E6%98%A0%E5%B0%84%E5%88%B0%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E6%8C%87%E5%AE%9A%E5%9C%B0%E5%9D%80%0A%3D%3Ddrm_gem_shmem_object_vunmap%3D%3D%0Ashmem_helper%3C-drm_gem%3Adrm_gem_shmem_object_vunmap()%0Arbox%20right%20of%20shmem_helper%3Adrm_gem_shmem_object_vunmap(%20)%5Cn%20%20%20%20%20%20%20%20%20drm_gem_shmem_vunmap(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20drm_gem_shmem_vunmap_locked(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201.%20vunmap()%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.%20drm_gem_shmem_put_pages()%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C-%5C-%3Edrm_gem_shmem_put_pages_locked(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C-%5C-%3Edrm_gem_put_pages(%20)%0A%3D%3Ddrm_gem_shmem_object_get_sg_table%3D%3D%0Ashmem_helper%3C-drm_gem%3Adrm_gem_shmem_object_get_sg_table(%20)%0Arbox%20right%20of%20shmem_helper%3Adrm_gem_shmem_object_get_sg_table(%20)%5Cn%20%20%20%20%20%20%20%20%5C-%5C-%3Edrm_gem_shmem_get_sg_table(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C-%5C-%3Edrm_prime_pages_to_sg(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201.kmalloc(struct%20sg_table)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.sg_alloc_table_from_pages_segment(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%E6%8A%8Apages%E5%A1%AB%E5%86%99%E5%88%B0sg_table%E4%B8%AD%0A%3D%3Ddrm_gem_shmem_object_pin%3D%3D%0Ashmem_helper%3C-drm_gem%3Adrm_gem_shmem_object_pin(%20)%0Arbox%20right%20of%20shmem_helper%3A%5C%2F%5C%2F%20%E5%BD%93%E8%A2%AB%E5%AF%BC%E5%87%BA%E6%97%B6%EF%BC%8C%E4%BF%9D%E8%AF%81%E7%9B%B8%E5%85%B3%E7%9A%84%E9%A1%B5%E9%9D%A2%E5%9B%BA%E5%AE%9A%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%5Cn%5Cndrm_gem_shmem_pin(%20)%5Cn%20%20%20%20%5C-%5C-%3Edrm_gem_shmem_get_pages(%20)%20%5C%2F%5C%2F%E5%8F%82%E8%A7%81%E4%B8%8A%E6%96%87%0A%3D%3Ddrm_gem_shmem_object_unpin%3D%3D%0Ashmem_helper%3C-drm_gem%3Adrm_gem_shmem_object_unpin(%20)%0Arbox%20right%20of%20shmem_helper%3A%5C%2F%5C%2F%20%E9%A1%B5%E9%9D%A2%E4%B8%8D%E5%86%8D%E9%9C%80%E8%A6%81%E5%9B%BA%E5%AE%9A%E5%9C%A8%E5%86%85%E5%AD%98%5Cn%5Cndrm_gem_shmem_unpin(%20)%5Cn%20%20%20%20%5C-%5C-%3Edrm_gem_shmem_put_pages(%20)%20%5C%2F%5C%2F%E5%8F%82%E8%A7%81%E4%B8%8A%E6%96%87%0A%3D%3Ddrm_gem_shmem_free%3D%3D%0Ashmem_helper%3C-drm_gem%3Adrm_gem_shmem_free(%20)%0Arbox%20right%20of%20shmem_helper%3A1.%20dma_unmap_sgtable(%20)%5Cn2.%20drm_gem_shmem_put_page(%20)%20%20%5Cn%20%20%20%20%20%20%20%5C-%5C-%3Edrm_gem_shmem_put_pages_locked(%20)%20%5C%2F%5C%2F%E5%8F%82%E8%A7%81%E5%89%8D%E6%96%87%5Cn%5Cn3.%20drm_gem_object_release(%20)%5Cn%20%20%20%20%20a.%20fput(obj-%3Efilp)%5Cn%20%20%20%20%20b.%20dma_resv_fini()%5Cn%20%20%20%20%20c.%20drm_gem_free_mmap_offset()%20%5C%2F%5C%2F%E5%8F%82%E8%80%83shmem%20dumb%20create%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5C-%5C-%3Edrm_vma_offset_remove(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C-%5C-%3Edrm_mm_remove_node(%20)%5Cn%5Cn4.%20kfree(shmem)</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="992" height="2333"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="374.1910054275599" y="26.3876361" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">shmem_helper for gem</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 61.2258309868125 103.26361593799999 L 61.2258309868125 2333.898454257999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 413.477241426526 103.26361593799999 L 413.477241426526 2333.898454257999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878699999996 55.765870957999994 L 113.65578327362499 55.765870957999994 L 113.65578327362499 103.26361593799999 L 8.795878699999996 103.26361593799999 L 8.795878699999996 55.765870957999994 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.882935478999997" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 343.04085756012364 55.765870957999994 L 483.9136252929284 55.765870957999994 L 483.9136252929284 103.26361593799999 L 343.04085756012364 103.26361593799999 L 343.04085756012364 55.765870957999994 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="362.12791433912366" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">shmem_helper</text></g></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 152.81373261466666 L 983.2041213 152.81373261466666 M 8.7958787 158.677651748 L 983.2041213 158.677651748 M 8.7958787 164.5415708813333 L 983.2041213 164.5415708813333" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 325.7666507239844 138.447130738 L 666.2333492760156 138.447130738 L 666.2333492760156 178.90817275799998 L 325.7666507239844 178.90817275799998 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="350.3951110839844" y="163.07559109800002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_prime_import_sg_table</text></g><g><g><rect fill="white" stroke="none" x="82.0427439101458" y="205.29580885799996" width="310.6175845930469" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="84.6815075201458" y="221.12839051799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_prime_import_sg_table( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 61.2258309868125 228.16509347799996 L 398.9933611671927 228.16509347799996" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(413.477241426526,228.16509347799996) translate(-413.477241426526,-228.16509347799996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 398.81744359319265 220.83519456133328 L 413.477241426526 228.16509347799996 L 398.81744359319265 235.49499239466664 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 413.477241426526 397.925552388 L 422.273120126526 397.925552388 M 422.273120126526 270.385311238 L 422.273120126526 270.385311238 A 15.832581659999999 15.832581659999999 0 0 1 438.105701786526 254.552729578 L 836.628138507815 254.55272957799997 L 836.628138507815 254.552729578 A 15.832581659999999 15.832581659999999 0 0 1 852.460720167815 270.385311238 L 852.460720167815 525.4657935380001 L 852.460720167815 525.4657935380001 A 15.832581659999999 15.832581659999999 0 0 1 836.628138507815 541.298375198 L 438.105701786526 541.298375198 L 438.105701786526 541.298375198 A 15.832581659999999 15.832581659999999 0 0 1 422.273120126526 525.4657935380001 L 422.273120126526 270.385311238" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="279.18118993800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//与上面</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="503.4084011652369" y="279.18118993800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_dumb_create</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="725.7420498468775" y="279.18118993800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )相类似的操作</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="296.77294733800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//构建gem_obj</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="314.36470473800006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="331.95646213800006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">_drm_gem_shmem_create( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="349.54821953800007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="367.1399769380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  1.if driver-&gt;gem_create_object is null, call it</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="384.7317343380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    or kzalloc(sizeof(shmem_obj))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="402.3234917380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="419.9152491380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  2. gem_obj-&gt;funcs = &amp;drm_gem_shmem_funcs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="437.5070065380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="455.0987639380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  3. drm_gem_object_init( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="472.6905213380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="490.2822787380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  4. drm_gem_create_mmap_offset()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="507.8740361380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="525.4657935380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">shmem-&gt;sgt = sgt //</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="595.3840633966822" y="525.4657935380001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">save sgt</text></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 582.0526131746667 L 983.2041213 582.0526131746667 M 8.7958787 587.916532308 L 983.2041213 587.916532308 M 8.7958787 593.7804514413333 L 983.2041213 593.7804514413333" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 361.0565448279883 567.6860112979999 L 630.9434551720117 567.6860112979999 L 630.9434551720117 608.147053318 L 361.0565448279883 608.147053318 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="385.6850051879883" y="592.314471658" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_vmap</text></g><g><g><rect fill="white" stroke="none" x="117.33263801414971" y="634.534689418" width="240.03779638503906" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="119.9714016241497" y="650.3672710779999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_vmap( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 61.2258309868125 657.403974038 L 398.9933611671927 657.403974038" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(413.477241426526,657.403974038) translate(-413.477241426526,-657.403974038)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 398.81744359319265 650.0740751213333 L 413.477241426526 657.403974038 L 398.81744359319265 664.7338729546667 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 413.477241426526 765.5932820480001 L 422.273120126526 765.5932820480001 M 422.273120126526 699.6241917980001 L 422.273120126526 699.6241917980001 A 15.832581659999999 15.832581659999999 0 0 1 438.105701786526 683.7916101380001 L 968.0738629951198 683.7916101380001 L 968.0738629951198 683.7916101380001 A 15.832581659999999 15.832581659999999 0 0 1 983.9064446551198 699.6241917980001 L 983.9064446551198 831.5623722980001 L 983.9064446551198 831.5623722980001 A 15.832581659999999 15.832581659999999 0 0 1 968.0738629951198 847.3949539580001 L 438.105701786526 847.3949539580001 L 438.105701786526 847.3949539580001 A 15.832581659999999 15.832581659999999 0 0 1 422.273120126526 831.5623722980001 L 422.273120126526 699.6241917980001" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="708.4200704980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_vmap( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="726.0118278980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  drm_gem_shmem_vmap_locked( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="743.6035852980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="761.1953426980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      1. </text><text fill="green" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="489.39259305976816" y="761.1953426980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_get_pages</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="692.291732464065" y="761.1953426980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( ) //见上面的实现</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="778.7871000980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="796.3788574980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      2. vmap( )//把不连续的物理内存映射到一个连续的虚拟内存</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="813.9706148980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="831.5623722980001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      3. dma_buf_map_set_vaddr( )//将dma-buf 映射到系统内存中的指定地址</text></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 888.1491919346668 L 983.2041213 888.1491919346668 M 8.7958787 894.0131110680001 L 983.2041213 894.0131110680001 M 8.7958787 899.8770302013334 L 983.2041213 899.8770302013334" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 352.0228991981055 873.782590058 L 639.9771008018945 873.782590058 L 639.9771008018945 914.243632078 L 352.0228991981055 914.243632078 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="376.65135955810547" y="898.4110504180001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_vunmap</text></g><g><g><rect fill="white" stroke="none" x="110.46792243797783" y="940.631268178" width="253.7672275373828" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="113.10668604797783" y="956.463849838" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_vunmap()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 61.2258309868125 963.5005527980001 L 398.9933611671927 963.5005527980001" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(413.477241426526,963.5005527980001) translate(-413.477241426526,-963.5005527980001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 398.81744359319265 956.1706538813334 L 413.477241426526 963.5005527980001 L 398.81744359319265 970.8304517146668 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 413.477241426526 1071.689860808 L 422.273120126526 1071.689860808 M 422.273120126526 1005.7207705580001 L 422.273120126526 1005.7207705580001 A 15.832581659999999 15.832581659999999 0 0 1 438.105701786526 989.8881888980002 L 849.262156452151 989.8881888980002 L 849.262156452151 989.8881888980002 A 15.832581659999999 15.832581659999999 0 0 1 865.0947381121509 1005.7207705580001 L 865.0947381121509 1137.6589510580002 L 865.0947381121509 1137.6589510580002 A 15.832581659999999 15.832581659999999 0 0 1 849.262156452151 1153.4915327180001 L 438.105701786526 1153.4915327180001 L 438.105701786526 1153.4915327180001 A 15.832581659999999 15.832581659999999 0 0 1 422.273120126526 1137.6589510580002 L 422.273120126526 1005.7207705580001" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1014.516649258" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_vunmap( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1032.108406658" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">         drm_gem_shmem_vunmap( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1049.700164058" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">            drm_gem_shmem_vunmap_locked( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1067.291921458" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">               </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1084.883678858" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                1. vunmap()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1102.475436258" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                2. drm_gem_shmem_put_pages()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1120.067193658" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                       --&gt;drm_gem_shmem_put_pages_locked( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1137.658951058" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                  --&gt;drm_gem_put_pages( )</text></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 1194.2457706946666 L 983.2041213 1194.2457706946666 M 8.7958787 1200.109689828 L 983.2041213 1200.109689828 M 8.7958787 1205.9736089613334 L 983.2041213 1205.9736089613334" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 336.70079379039066 1179.8791688180002 L 655.2992062096093 1179.8791688180002 L 655.2992062096093 1220.340210838 L 336.70079379039066 1220.340210838 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="361.3292541503906" y="1204.507629178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_get_sg_table</text></g><g><g><rect fill="white" stroke="none" x="92.97688697655205" y="1246.727846938" width="288.7492984602344" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="95.61565058655205" y="1262.560428598" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_get_sg_table( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 61.2258309868125 1269.597131558 L 398.9933611671927 1269.597131558" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(413.477241426526,1269.597131558) translate(-413.477241426526,-1269.597131558)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 398.81744359319265 1262.2672326413333 L 413.477241426526 1269.597131558 L 398.81744359319265 1276.9270304746667 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 413.477241426526 1360.1946821679999 L 422.273120126526 1360.1946821679999 M 422.273120126526 1311.817349318 L 422.273120126526 1311.817349318 A 15.832581659999999 15.832581659999999 0 0 1 438.105701786526 1295.984767658 L 865.131785358401 1295.984767658 L 865.131785358401 1295.984767658 A 15.832581659999999 15.832581659999999 0 0 1 880.9643670184009 1311.817349318 L 880.9643670184009 1408.572015018 L 880.9643670184009 1408.572015018 A 15.832581659999999 15.832581659999999 0 0 1 865.131785358401 1424.404596678 L 438.105701786526 1424.404596678 L 438.105701786526 1424.404596678 A 15.832581659999999 15.832581659999999 0 0 1 422.273120126526 1408.572015018 L 422.273120126526 1311.817349318" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1320.6132280179997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_get_sg_table( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1338.2049854179998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        --&gt;drm_gem_shmem_get_sg_table( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1355.7967428179998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                      --&gt;drm_prime_pages_to_sg( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1373.3885002179998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                              1.kmalloc(struct sg_table)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1390.9802576179998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                              2.sg_alloc_table_from_pages_segment( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1408.5720150179998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                 //把pages填写到sg_table中</text></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 1465.1588346546664 L 983.2041213 1465.1588346546664 M 8.7958787 1471.0227537879998 L 983.2041213 1471.0227537879998 M 8.7958787 1476.8866729213332 L 983.2041213 1476.8866729213332" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 369.35647921519535 1450.792232778 L 622.6435207848047 1450.792232778 L 622.6435207848047 1491.253274798 L 369.35647921519535 1491.253274798 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="393.9849395751953" y="1475.4206931379997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_pin</text></g><g><g><rect fill="white" stroke="none" x="125.63257240135674" y="1517.640910898" width="223.437927610625" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="128.27133601135674" y="1533.4734925579999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_pin( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 61.2258309868125 1540.5101955179998 L 398.9933611671927 1540.5101955179998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(413.477241426526,1540.5101955179998) translate(-413.477241426526,-1540.5101955179998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 398.81744359319265 1533.180296601333 L 413.477241426526 1540.5101955179998 L 398.81744359319265 1547.8400944346665 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 413.477241426526 1613.5159887279997 L 422.273120126526 1613.5159887279997 M 422.273120126526 1582.7304132779998 L 422.273120126526 1582.7304132779998 A 15.832581659999999 15.832581659999999 0 0 1 438.105701786526 1566.8978316179998 L 789.140574420901 1566.8978316179998 L 789.140574420901 1566.8978316179998 A 15.832581659999999 15.832581659999999 0 0 1 804.9731560809009 1582.7304132779998 L 804.9731560809009 1644.3015641779998 L 804.9731560809009 1644.3015641779998 A 15.832581659999999 15.832581659999999 0 0 1 789.140574420901 1660.1341458379998 L 438.105701786526 1660.1341458379998 L 438.105701786526 1660.1341458379998 A 15.832581659999999 15.832581659999999 0 0 1 422.273120126526 1644.3015641779998 L 422.273120126526 1582.7304132779998" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1591.5262919779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">// 当被导出时，保证相关的页面固定在内存中</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1609.1180493779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1626.7098067779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_pin( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1644.3015641779996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    --&gt;drm_gem_shmem_get_pages( ) //参见上文</text></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 1700.8883838146662 L 983.2041213 1700.8883838146662 M 8.7958787 1706.7523029479996 L 983.2041213 1706.7523029479996 M 8.7958787 1712.616222081333 L 983.2041213 1712.616222081333" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 360.32283358531254 1686.5217819379998 L 631.6771664146875 1686.5217819379998 L 631.6771664146875 1726.9828239579997 L 360.32283358531254 1726.9828239579997 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="384.9512939453125" y="1711.1502422979995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_unpin</text></g><g><g><rect fill="white" stroke="none" x="116.59892677147393" y="1753.3704600579997" width="241.50521887039062" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="119.23769038147393" y="1769.2030417179997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_object_unpin( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 61.2258309868125 1776.2397446779996 L 398.9933611671927 1776.2397446779996" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(413.477241426526,1776.2397446779996) translate(-413.477241426526,-1776.2397446779996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 398.81744359319265 1768.909845761333 L 413.477241426526 1776.2397446779996 L 398.81744359319265 1783.5696435946663 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 413.477241426526 1849.2455378879995 L 422.273120126526 1849.2455378879995 M 422.273120126526 1818.4599624379996 L 422.273120126526 1818.4599624379996 A 15.832581659999999 15.832581659999999 0 0 1 438.105701786526 1802.6273807779996 L 789.8420514716822 1802.6273807779996 L 789.8420514716822 1802.6273807779996 A 15.832581659999999 15.832581659999999 0 0 1 805.6746331316822 1818.4599624379996 L 805.6746331316822 1880.0311133379996 L 805.6746331316822 1880.0311133379996 A 15.832581659999999 15.832581659999999 0 0 1 789.8420514716822 1895.8636949979996 L 438.105701786526 1895.8636949979996 L 438.105701786526 1895.8636949979996 A 15.832581659999999 15.832581659999999 0 0 1 422.273120126526 1880.0311133379996 L 422.273120126526 1818.4599624379996" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1827.2558411379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">// 页面不再需要固定在内存</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1844.8475985379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1862.4393559379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_unpin( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="1880.0311133379994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    --&gt;drm_gem_shmem_put_pages( ) //参见上文</text></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 1936.617932974666 L 983.2041213 1936.617932974666 M 8.7958787 1942.4818521079994 L 983.2041213 1942.4818521079994 M 8.7958787 1948.3457712413328 L 983.2041213 1948.3457712413328" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 392.10164217906254 1922.2513310979996 L 599.8983578209375 1922.2513310979996 L 599.8983578209375 1962.7123731179995 L 392.10164217906254 1962.7123731179995 Z" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="416.7301025390625" y="1946.8797914579993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_free</text></g><g><g><rect fill="white" stroke="none" x="148.3777353652239" y="1989.1000092179995" width="177.94760168289062" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="151.01649897522393" y="2004.9325908779995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_gem_shmem_free( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 61.2258309868125 2011.9692938379994 L 398.9933611671927 2011.9692938379994" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(413.477241426526,2011.9692938379994) translate(-413.477241426526,-2011.9692938379994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 398.81744359319265 2004.6393949213327 L 413.477241426526 2011.9692938379994 L 398.81744359319265 2019.2991927546661 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 413.477241426526 2155.3421166479993 L 422.273120126526 2155.3421166479993 M 422.273120126526 2054.1895115979996 L 422.273120126526 2054.1895115979996 A 15.832581659999999 15.832581659999999 0 0 1 438.105701786526 2038.3569299379997 L 891.4025983466822 2038.3569299379994 L 891.4025983466822 2038.3569299379997 A 15.832581659999999 15.832581659999999 0 0 1 907.2351800066822 2054.1895115979996 L 907.2351800066822 2256.4947216979995 L 907.2351800066822 2256.4947216979995 A 15.832581659999999 15.832581659999999 0 0 1 891.4025983466822 2272.3273033579994 L 438.105701786526 2272.3273033579994 L 438.105701786526 2272.3273033579994 A 15.832581659999999 15.832581659999999 0 0 1 422.273120126526 2256.4947216979995 L 422.273120126526 2054.1895115979996" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2062.985390297999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. dma_unmap_sgtable( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2080.577147697999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. drm_gem_shmem_put_page( )  </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2098.168905097999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       --&gt;drm_gem_shmem_put_pages_locked( ) //参见前文</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2115.760662497999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2133.352419897999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. drm_gem_object_release( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2150.944177297999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     a. fput(obj-&gt;filp)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2168.535934697999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     b. dma_resv_fini()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2186.127692097999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     c. drm_gem_free_mmap_offset() //参考shmem dumb create</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2203.719449497999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">            --&gt;drm_vma_offset_remove( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2221.311206897999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        --&gt;drm_mm_remove_node( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2238.902964297999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.901580486526" y="2256.494721697999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. kfree(shmem)</text></g></g><g/><g/></g></svg>