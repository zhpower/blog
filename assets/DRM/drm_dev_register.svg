<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="818" height="571"><desc>title%20drm_dev_register%0A%0ADriver%20-%3Edrm_drv%3A%3Ccolor%3A%23ff0066%3Edrm_dev_register%3C%2Fcolor%3E(%20)%0Arbox%20over%20drm_drv%3A1.%20drm_minor_register(%20)%20%20%5C-%5C-%3Edevice_add(%20)%20%5C%2F%5C%2F%20%E6%B7%BB%E5%8A%A0%20dev-%3Eprimary%20%2C%20dev-%3Erender%5Cn%5Cn2.%20create_compat_control_link()%20%5C-%5C-%3Esysfs_create_link(%20)%20%5C%2F%5C%2F%E5%88%9B%E5%BB%BA%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6%5Cn%5Cn3.%20if%20DRIVER_MODESET%2C%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_modeset_register_all(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20a.%20drm_plane_register_all()%20%20%20%20%20%5C%2F%5C%2F%20call%20%3Ccolor%3A%23ff00ff%3Eplane%5C-%3Efuncs%5C-%3Elate_register()%3C%2Fcolor%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20b.%20drm_crtc_register_all()%20%20%20%20%20%20%20%20%5C%2F%5C%2F%20call%20%3Ccolor%3A%23ff00ff%3Ecrtc%5C-%3Efuncs%5C-%3Elate_register()%3C%2Fcolor%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20c.%20drm_encoder_register_all()%20%20%5C%2F%5C%2F%20call%20%3Ccolor%3A%23ff00ff%3Eencoder%5C-%3Efuncs%5C-%3Elate_register()%3C%2Fcolor%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20d.%20drm_connector_register_all()%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C-%5C-%3Edrm_connector_register()%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201.drm_sysfs_connector_add()%20%2F%5C%2F%E5%9C%A8%2Fsys%2Fdevices%2Fplatform%2F%E4%B8%8B%E5%88%9B%E5%BB%BA%E8%AE%BE%E5%A4%87%20%22ddc%22%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.call%20%3Ccolor%3A%23ff00ff%3Econnector%5C-%3Efuncs%5C-%3Elate_register()%3C%2Fcolor%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203.drm_mode_object_register(%26connector%5C-%3Ebase)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204.drm_sysfs_hotplug_event()%20%20%5C-%5C-%3Ekobject_uevent_env(%20)%5Cn%5Cn%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="818" height="571"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 48.97455687792578 103.10369087072726 L 48.97455687792578 571.0444377107274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 433.87339850140233 103.10369087072726 L 433.87339850140233 571.0444377107274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878699999996 55.60594589072727 L 89.15323505585155 55.60594589072727 L 89.15323505585155 103.10369087072726 L 8.795878699999996 103.10369087072726 L 8.795878699999996 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.882935478999997" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Driver</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 385.5057249621484 55.60594589072727 L 482.2410720406562 55.60594589072727 L 482.2410720406562 103.10369087072726 L 385.5057249621484 103.10369087072726 L 385.5057249621484 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="404.5927817411484" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_drv</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="321.52415466308594" y="26.547561167272725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_dev_register</text></g><g><g><rect fill="white" stroke="none" x="171.59837020759372" y="138.28720567072727" width="139.65121496414062" height="22.86928462"/></g><text fill="#ff0066" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="174.23713381759373" y="154.1197873307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_dev_register</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="294.48054202071876" y="154.1197873307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 48.97455687792578 161.15649029072728 L 419.389518242069 161.15649029072728" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(433.87339850140233,161.15649029072728) translate(-433.87339850140233,-161.15649029072728)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 419.213600668069 153.8265913740606 L 433.87339850140233 161.15649029072728 L 419.213600668069 168.48638920739396 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 57.77043557792575 203.37670805072727 L 57.77043557792575 203.37670805072727 A 15.832581659999999 15.832581659999999 0 0 1 73.60301723792576 187.54412639072729 L 794.1437797648789 187.54412639072729 L 794.1437797648789 187.54412639072729 A 15.832581659999999 15.832581659999999 0 0 1 809.9763614248789 203.37670805072727 L 809.9763614248789 493.64070515072734 L 809.9763614248789 493.64070515072734 A 15.832581659999999 15.832581659999999 0 0 1 794.1437797648789 509.47328681072736 L 73.60301723792576 509.47328681072736 L 73.60301723792576 509.47328681072736 A 15.832581659999999 15.832581659999999 0 0 1 57.77043557792575 493.64070515072734 L 57.77043557792575 203.37670805072727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="212.17258675072733" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. drm_minor_register( )  --&gt;device_add( ) // 添加 dev-&gt;primary , dev-&gt;render</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="247.35610155072735" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. create_compat_control_link() --&gt;sysfs_create_link( ) //创建链接文件</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="282.53961635072733" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. if DRIVER_MODESET, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="300.13137375072733" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_modeset_register_all( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="317.72313115072734" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                          a. drm_plane_register_all()     // call </text><text fill="#ff00ff" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.14312811566015" y="317.72313115072734" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">plane-&gt;funcs-&gt;late_register()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="335.31488855072735" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                          b. drm_crtc_register_all()        // call </text><text fill="#ff00ff" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="444.71075506878515" y="335.31488855072735" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">crtc-&gt;funcs-&gt;late_register()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="352.90664595072735" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                          c. drm_encoder_register_all()  // call </text><text fill="#ff00ff" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="447.9749762601914" y="352.90664595072735" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">encoder-&gt;funcs-&gt;late_register()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="370.49840335072736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                          d. drm_connector_register_all()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="388.09016075072736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                  --&gt;drm_connector_register()         </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="405.68191815072737" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                             1.drm_sysfs_connector_add() //在/sys/devices/platform/下创建设备 "ddc"</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="423.2736755507274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                             2.call </text><text fill="#ff00ff" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="317.32342596722265" y="423.2736755507274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">connector-&gt;funcs-&gt;late_register()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="440.8654329507274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                             3.drm_mode_object_register(&amp;connector-&gt;base)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.39889593792577" y="458.4571903507274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                             4.drm_sysfs_hotplug_event()  --&gt;kobject_uevent_env( )</text></g></g><g/><g/></g></svg>