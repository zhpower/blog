<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1783" height="4486"><desc>title%20drm_atomic%0A%0AApp%20-%3E%20libdrm%3AdrmSetClientCap(fd%2C%20%5Cn%20%20%20%20%3Ccolor%3A%23red%3EDRM_CLIENT_CAP_ATOMIC%3C%2Fcolor%3E%2C%201)%3B%0A%0Alibdrm%20-%3E%20drm_drv%3Aioctl(%3Ccolor%3A%23red%3EDRM_CLIENT_CAP_ATOMIC%3C%2Fcolor%3E)%0Arbox%20right%20of%20drm_drv%3Adrm_setclientcap(%20)%5Cn%20%20%20if(%20!drm_core_check_feature(dev%2C%20%3Ccolor%3A%23red%3EDRIVER_ATOMIC%3C%2Fcolor%3E))%20return%20false%5Cn%20%20%20%3Ccolor%3A%23green%3Eor%3C%2Fcolor%3E%5Cn%20%20%20file_priv-%3Eatomic%20%3D%201%3B%5Cn%20%20%20file_priv-%3Euniversal_planes%20%3D%201%3B%0A%0A%3D%3D%3D%3D%0AApp-%3Elibdrm%3AdrmModeAtomicAlloc(%20)%20%20%20%20%20%20%20%20%20%20%20%20%0Arbox%20right%20of%20libdrm%3AdrmMalloc(%20)%5Cn%5C%2F%5C%2F%20%E5%88%86%E9%85%8D%20%3Ccolor%3A%23purple%3EdmModeAtomicReqPtr%3C%2Fcolor%3E%0AApp%3C%3C--libdrm%3A%3Ccolor%3A%23purple%3EdmModeAtomicReqPtr%3C%2Fcolor%3E%0AApp-%3Elibdrm%3AdrmModeAtomicAddProperty(%20)%0Arbox%20right%20of%20libdrm%3Asave%20to%20%3Ccolor%3A%23purple%3EdmModeAtomicReqPtr%3C%2Fcolor%3E%0AApp-%3Elibdrm%3AdrmModeAtomicCommit()%20%20%20%20%20%20%20%20%0Alibdrm-%3Edrm_drv%3Aiotcl(%3Ccolor%3A%23red%3EDRM_IOCTL_MODE_ATOMIC%3C%2Fcolor%3E)%0A%0Adrm_drv%20-%3E%20drm_atomic_uapi%3Adrm_mode_atomic_ioctl(%20)%0Adrm_atomic_uapi%20-%3E%20drm_atomic%3A%3Cbackground%3A%23yellow%3Edrm_atomic_state_alloc(%20)%3C%2Fbackground%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%5C%2F%5C%2F%E5%88%86%E9%85%8D%20drm_atomic_state%0Arbox%20left%20of%20drm_atomic%3Aif%20%20no%20NULL%5Cn%20%20%20%20%20%3Ccolor%3A%23red%3Econfig-%3Efuncs-%3Eatomic_state_alloc(%20)%3C%2Fcolor%3E%5Cn%20%20%20%20%20%20%5C%2F%5C%2Fdrm_mode_config_funcs%E4%B8%AD%E8%AE%BE%E5%AE%9A%5Cn%5Cn%20%20%20%20%3Cbackground%3A%23FFCCFF%3Eor%3C%2Fbackground%3E%5Cn%20%20%20%20%20%20kzalloc(sizeof(drm_atomic_state))%5Cn%20%20%20%20%20%20%3Ccolor%3A%23green%3Edrm_atomic_state_init%3C%2Fcolor%3E(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%201.%20kcalloc(num*sizeof(%3Ccolor%3A%23purple%3E__drm_crtcs_state%3C%2Fcolor%3E))%20%20%20%20%5C-%5C-%3E%20state-%3Ecrtcs%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%202.%20kcalloc(num*sizeof(%3Ccolor%3A%23purple%3E__drm_planes_state%3C%2Fcolor%3E))%20%20%5C-%5C-%3E%20state-%3Eplanes%0A%0A%0Arbox%20right%20of%20drm_atomic_uapi%3A%3Cbackground%3A%23yellow%3E%5C%2F%5C%2F%E4%BF%9D%E5%AD%98%E5%90%84%E7%A7%8Dproperty%E5%88%B0%E5%AF%B9%E5%BA%94crtc%2C%20connector%2C%20plane%E7%9A%84state%3C%2Fbackground%3E%5Cn%3Cbackground%3A%23yellow%3E%5C%2F%5C%2F%E5%AF%B9%E5%BA%94state%E5%8F%AF%E8%83%BD%E6%98%AF%E6%96%B0%E5%88%86%E9%85%8D%E7%9A%84%3C%2Fbackground%3E%5Cn%5Cnfor%20each%20obj%5Cn%20%20for%20each%20prop%5Cn%20%20%20%20%20drm_atomic_set_property(%20)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20case%20connector%3A%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_get_connector_state()%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_connector_set_property()%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20case%20crtc%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_get_crtc_state(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_crtc_set_property(%20)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20case%20plane%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_get_plane_state(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_plane_set_property(%20)%0A%0Agroup%20connector%0A%0Adrm_atomic_uapi-%3Edrm_atomic%3Adrm_atomic_get_connector_state(%20)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0Arbox%20left%20of%20drm_atomic%3Aconnector-%3Efuncs-%3E%3Ccolor%3A%23red%3Eatomic_duplicate_state%3C%2Fcolor%3E(connector)%3B%5Cn%5C%2F%5C%2F%E5%BE%97%E5%88%B0new%20connector_state%5Cn%5Cn%5C%2F%5C%2F%20state%E6%98%AF%E5%9C%A8%3Ccolor%3A%23green%3Edrm_atomic_state_init%3C%2Fcolor%3E()%E4%B8%AD%E5%88%86%E9%85%8D%5Cn%09state-%3Econnectors%5Bindex%5D.%3Ccolor%3A%23red%3Eold_state%3C%2Fcolor%3E%20%3D%20connector-%3Estate%3B%5Cn%09state-%3Econnectors%5Bindex%5D.%3Ccolor%3A%23red%3Enew_state%3C%2Fcolor%3E%20%3D%20connector_state%3B%5Cn%09state-%3Econnectors%5Bindex%5D.ptr%20%3D%20connector%3B%5Cn%09connector_state-%3Estate%20%3D%20state%3B%5Cn%5Cnreturn%20new%20%3Ccolor%3A%23red%3Econnector_state%3C%2Fcolor%3E%0Adrm_atomic_uapi-%3Edrm_atomic%3Adrm_atomic_connector_set_property(%20%3Ccolor%3A%23red%3Econnector_state%3C%2Fcolor%3E%20)%0Arbox%20left%20of%20drm_atomic%3Aif%20property%20%E5%86%85%E9%83%A8%E5%AE%9A%E4%B9%89%5Cn%20%20%20%E8%AE%BE%E7%BD%AE%3Ccolor%3A%23red%3Econnector_state%3C%2Fcolor%3E%20%E5%AF%B9%E5%BA%94%E5%AD%97%E6%AE%B5%5Cn%5Cn%3Cbackground%3A%23FFCCFF%3Eor%3C%2Fbackground%3E%5Cn%20%20%20%20%E8%B0%83%E7%94%A8connector-%3Efuncs-%3E%3Ccolor%3A%23red%3Eatomic_set_property%3C%2Fcolor%3E(%20)%0A%0Aend%0Agroup%20crtc%20plane%20%E4%B8%8Econnector%E7%9B%B8%E4%BC%BC%E6%93%8D%E4%BD%9C%0Adrm_atomic_uapi-%3Edrm_atomic%3Adrm_atomic_get_%3Ccolor%3A%23purple%3Exxx%3C%2Fcolor%3E_state(%20)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0Adrm_atomic_uapi-%3Edrm_atomic%3Adrm_atomic_%3Ccolor%3A%23purple%3Exxx%3C%2Fcolor%3E_set_property(%20%3Ccolor%3A%23red%3Exxx_state%3C%2Fcolor%3E%20)%20%20%20%20%20%20%20%20%20%20%0Aend%0Arbox%20right%20of%20drm_atomic_uapi%3A%3Cbackground%3A%23yellow%3Eprepare_signaling(%20)%3C%2Fbackground%3E%5Cn%20%5C%2F%5C%2F%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%5Cn%5Cn%20%20%20%20%20%20%20%20for%20each%20crtc%20%5C%2F%5C%2F%20%3Cbackground%3A%23CCE5FF%3ETODO%3A%3C%2Fbackground%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20drm_crtc_create_fence()%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20setup_out_fence()%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%20%E6%9E%84%E5%BB%BA%E6%96%B0fence%EF%BC%8C%20%E6%8A%8A%E6%89%80%E6%9C%89fence%E4%BF%9D%E5%AD%98%E5%88%B0%20fence_state%5Cn%5Cn%20%20%20%20%20%20%20%20%20for%20each%20connector%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%20for%20writeback%20%E5%9B%9E%E5%86%99%E8%BF%9E%E6%8E%A5%E5%99%A8%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%0Adrm_atomic_uapi-%3Edrm_atomic%3A%3Cbackground%3A%23yellow%3Edrm_atomic_commit%3C%2Fbackground%3E(%20)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%5C-%5C-%3E%3Ccolor%3A%23red%3Emode_config-%3Efuncs-%3Eatomic_commit%3C%2Fcolor%3E(%20)%0Adrm_drv(2)%3C--drm_atomic_uapi%3A%0Arbox%20right%20of%20drm_drv%3A%5C%2F%5C%2Fdrm%20%E6%8F%90%E4%BE%9B%E7%9A%84%20mode_config%20%3Ccolor%3A%23red%3Eatomic_commit%3C%2Fcolor%3E%E5%AE%9E%E7%8E%B0%5Cn%5C%2F%5C%2Fdrm_atomic_helper.c%5Cn%5Cndrm_atomic_helper_commit(%20)%5Cn%5Cnif(state-%3Easync_update)%20%5C%2F%5C%2F%20%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%5Cn%5Cn%20%20%20%20%20%3Cbackground%3A%23lightgray%3Edrm_atomic_helper_prepare_planes(%20)%3C%2Fbackground%3E%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20for%20each%20new%20plane%20in%20state%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%20plane-%3Ehelper_funcs-%3Eprepare_fb%20no%20NULL)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ccolor%3A%23red%3Eplane-%3Ehelper_funcs-%3Eprepare_fb(%20)%3C%2Fcolor%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20or%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_gem_plane_helper_prepare_fb(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_set_fence_for_plane(%20)%5Cn%5Cn%20%20%20%20%20%3Cbackground%3A%23lightgray%3Edrm_atomic_helper_async_commit(%20)%3C%2Fbackground%3E%5Cn%5Cn%20%20%20%20%20%20%20%20for%20each%20new%20plane%20in%20state%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20if(plane-%3Ehelper_funcs-%3Eatomic_async_update%20no%20NULL)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ccolor%3A%23red%3Eplane-%3Ehelpr_funcs-%3Eatomic_async_update(%20)%3C%2Fcolor%3E%20%5Cn%5Cn%20%20%20%20%20%3Cbackground%3A%23lightgray%3Edrm_atomic_helper_cleanup_planes(%20)%3C%2Fbackground%3E%5Cn%5Cn%20%20%20%20%20%20%20%20%20for%20each%20new%20plane%20in%20state%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ccolor%3A%23red%3Eplane-%3Ehelp_funcs-%3Ecleanup_fb(%20)%3C%2Fcolor%3E%5Cn%5Cn%3Ccolor%3A%23green%3Eor%3C%2Fcolor%3E%20%20%5C%2F%5C%2F%E5%90%8C%E6%AD%A5%E6%9B%B4%E6%96%B0%5Cn%5Cn%20%20%20%20%20%3Cbackground%3A%23CCFFE5%3Edrm_atomic_helper_setup_commit(%20)%3C%2Fbackground%3E%5Cn%20%20%20%20%20%5C%2F%5C%2F%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%EF%BC%8C%E4%BB%A5%E6%94%AF%E6%8C%81%E9%9D%9E%E9%98%BB%E5%A1%9E%E6%8F%90%E4%BA%A4%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20a.%20init_completion%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20b.%20mode_config-%3Ehelp_funcs-%3E%3Ccolor%3A%23red%3Eatomic_commit_setup(%20)%3C%2Fcolor%3E%5Cn%5Cn%20%20%20%20%20%3Cbackground%3A%23CCFFE5%3EINIT_WORK%20%3Ccolor%3A%23red%3Ecommit_work%3C%2Fcolor%3E%3C%2Fbackground%3E%20%5C%2F%5C%2F%20%E5%88%9D%E5%A7%8B%E5%8C%96%E5%B7%A5%E4%BD%9C%E9%A1%B9%20%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8Ccommit_tail(%20)%5Cn%5Cn%20%20%20%20%20%3Cbackground%3A%23CCFFE5%3Edrm_atomic_helper_prepare_planes(%20)%3C%2Fbackground%3E%5Cn%5Cn%20%20%20%20%20if(%20block)%20%5Cn%20%20%20%20%20%20%20%20%20%20drm_atomic_helper_wait_for_fences(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%20%E5%9C%A8drm_atomic_helper_prepare_planes()%E4%B8%AD%E8%AE%BE%E7%BD%AE%E7%9A%84fence%EF%BC%9F%5Cn%5Cn%20%20%20%20%20%3Cbackground%3A%23CCFFE5%3Edrm_atomic_helper_swap_state(%20)%3C%2Fbackground%3E%5Cn%5Cn%20%20%20%20%20if(%20nonblock)%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbackground%3A%23CCFFE5%3Equeue_work(system_unbound_wq%2C%20commit_work)%3C%2Fbackground%3E%5Cn%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%E7%BA%BF%E7%A8%8B%E6%89%A7%E8%A1%8Ccommit_tail()%5Cn%5Cn%20%20%20%20%20%20or%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbackground%3A%23CCFFE5%3Ecommit_tail(%20)%3C%2Fbackground%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C%2F%5C%2F%E7%AD%89%E5%BE%85%E5%9C%A8old_state%E4%B8%AD%E5%85%88%E5%89%8D%E6%8F%90%E4%BA%A4%E7%9A%84%E5%AE%8C%E6%88%90%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_helper_wait_for_fences(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_helper_wait_for_dependencies(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wait_for_completion_timeout()%20%5C%2F%5C%2Fcrtc%2C%20connector%2C%20plane%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20no%20null%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode_config-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Eatomic_commit_tail()%3C%2Fcolor%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20or%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_helper_commit_tail(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201.%20drm_atomic_helper_commit_modeset_disables(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20disable_output(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20encoder-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Eatomic_disable%3C%2Fcolor%3E(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20crtc-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Eatomic_disable%3C%2Fcolor%3E(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202.%20drm_atomic_helper_commit_planes(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20crtc-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Eatomic_begin%3C%2Fcolor%3E(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plane-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Eatomic_update%3C%2Fcolor%3E(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20crtc-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Eatomic_flush%3C%2Fcolor%3E(%20)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203.%20drm_atomic_helper_commit_modeset_enables(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20crtc-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Eatomic_enable%3C%2Fcolor%3E(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20encoder-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Eatomic_enable%3C%2Fcolor%3E(%20)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204.%20drm_atomic_helper_fake_vblank(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_crtc_send_vblank_event(%20)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%205.%20drm_atomic_helper_commit_hw_done(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20complete_all(hw_done)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%206.%20drm_atomic_helper_wait_for_vblanks(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wait_event_timeout()%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%207.%20drm_atomic_helper_cleanup_planes(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20plane-%3Ehelper_funcs-%3E%3Ccolor%3A%23red%3Ecleanup_fb%3C%2Fcolor%3E(%20)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20drm_atomic_helper_commit_cleanup_done(%20)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0Arbox%20right%20of%20drm_atomic_uapi%3A%3Cbackground%3A%23yellow%3Ecomplete_signaling%3C%2Fbackground%3E(%20)%5Cn%5C%2F%5C%2F%E5%96%84%E5%90%8E%E5%B7%A5%E4%BD%9C%5Cn%5Cn%20%20%20%20%20if%20atomic_commit()%20%E6%88%90%E5%8A%9F%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%5C-%5C-%3E%20fd_install(fence_state%5Bi%5D.fd%2C%20fence_state%5Bi%5D.sync_file-%3Efile)%5Cn%5Cn%20%20%20%20%20%20or%5Cn%20%20%20%20%20%20%20%20%20%20fput(fence_state%5Bi%5D.fd)%5Cn%20%20%20%20%20%20%20%20%20%20put_unused_fd(fence_state%5Bi%5D.sync_file-%3Efile)%3B%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1783" height="4486"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 42.40332885058203 103.10369087072726 L 42.40332885058203 4486.969634950727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 322.70054617506116 103.10369087072726 L 322.70054617506116 4486.969634950727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.6528080552043 103.10369087072726 L 608.6528080552043 4486.969634950727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 103.10369087072726 L 1151.1921600033293 4486.969634950727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1704.6620692024308 103.10369087072726 L 1704.6620692024308 4486.969634950727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878699999996 55.60594589072727 L 76.01077900116405 55.60594589072727 L 76.01077900116405 103.10369087072726 L 8.795878699999996 103.10369087072726 L 8.795878699999996 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.882935478999997" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">App</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 280.6893637246744 55.60594589072727 L 364.71172862544785 55.60594589072727 L 364.71172862544785 103.10369087072726 L 280.6893637246744 103.10369087072726 L 280.6893637246744 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="299.77642050367444" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">libdrm</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 560.2851345159504 55.60594589072727 L 657.0204815944583 55.60594589072727 L 657.0204815944583 103.10369087072726 L 560.2851345159504 103.10369087072726 L 560.2851345159504 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="579.3721912949504" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_drv</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1072.1158301530402 55.60594589072727 L 1230.2684898536183 55.60594589072727 L 1230.2684898536183 103.10369087072726 L 1072.1158301530402 103.10369087072726 L 1072.1158301530402 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1091.2028869320402" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_uapi</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1644.0717775601495 55.60594589072727 L 1765.252360844712 55.60594589072727 L 1765.252360844712 103.10369087072726 L 1644.0717775601495 103.10369087072726 L 1644.0717775601495 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1663.1588343391495" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="831.113639831543" y="26.547561167272725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic</text></g><g><g><rect fill="white" stroke="none" x="63.22024177391533" y="138.28720567072725" width="151.11862219070312" height="22.86928462"/></g><g><rect fill="white" stroke="none" x="63.22024177391533" y="155.87896307072725" width="238.6633914778125" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="65.85900538391533" y="154.11978733072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drmSetClientCap(fd, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="65.85900538391533" y="171.71154473072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="83.21044581360283" y="171.71154473072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DRM_CLIENT_CAP_ATOMIC</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="274.3558162970013" y="171.71154473072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">, 1);</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 42.40332885058203 178.74824769072725 L 308.21666591572784 178.74824769072725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(322.70054617506116,178.74824769072725) translate(-322.70054617506116,-178.74824769072725)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 308.0407483417278 171.41834877406058 L 322.70054617506116 178.74824769072725 L 308.0407483417278 186.07814660739393 Z"/></g></g><g><g><rect fill="white" stroke="none" x="347.6012298503476" y="205.13588379072726" width="236.1508945295703" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="350.2399934603476" y="220.96846545072728" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ioctl(</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="385.0717805697226" y="220.96846545072728" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DRM_CLIENT_CAP_ATOMIC</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="576.217151053121" y="220.96846545072728" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 322.70054617506116 228.00516841072726 L 594.168927795871 228.00516841072726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.6528080552043,228.00516841072726) translate(-608.6528080552043,-228.00516841072726)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 593.993010221871 220.6752694940606 L 608.6528080552043 228.00516841072726 L 593.993010221871 235.33506732739394 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 608.6528080552043 309.80684032072725 L 617.4486867552043 309.80684032072725 M 617.4486867552043 270.2253861707273 L 617.4486867552043 270.2253861707273 A 15.832581659999999 15.832581659999999 0 0 1 633.2812684152043 254.3928045107273 L 1102.3333529636418 254.39280451072727 L 1102.3333529636418 254.3928045107273 A 15.832581659999999 15.832581659999999 0 0 1 1118.1659346236418 270.2253861707273 L 1118.1659346236418 349.38829447072726 L 1118.1659346236418 349.38829447072726 A 15.832581659999999 15.832581659999999 0 0 1 1102.3333529636418 365.2208761307273 L 633.2812684152043 365.2208761307273 L 633.2812684152043 365.2208761307273 A 15.832581659999999 15.832581659999999 0 0 1 617.4486867552043 349.38829447072726 L 617.4486867552043 270.2253861707273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="279.0212648707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_setclientcap( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="296.6130222707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   if( !drm_core_check_feature(dev, </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="883.6519762167668" y="296.6130222707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DRIVER_ATOMIC</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1000.072920430634" y="296.6130222707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)) return false</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="314.2047796707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   </text><text fill="green" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="655.0907274374699" y="314.2047796707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="331.7965370707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   file_priv-&gt;atomic = 1;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="349.3882944707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   file_priv-&gt;universal_planes = 1;</text></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.7958787 405.9751141073939 L 1774.2041213 405.9751141073939 M 8.7958787 411.83903324072725 L 1774.2041213 411.83903324072725 M 8.7958787 417.7029523740606 L 1774.2041213 417.7029523740606" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><g><rect fill="white" stroke="none" x="69.53738044579033" y="458.4571903507273" width="226.0291141340625" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="72.17614405579033" y="474.2897720107273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drmModeAtomicAlloc( )            </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 42.40332885058203 481.32647497072725 L 308.21666591572784 481.32647497072725" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(322.70054617506116,481.32647497072725) translate(-322.70054617506116,-481.32647497072725)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 308.0407483417278 473.9965760540606 L 322.70054617506116 481.32647497072725 L 308.0407483417278 488.6563738873939 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 322.70054617506116 536.7405107807273 L 331.49642487506117 536.7405107807273 M 331.49642487506117 523.5466927307273 L 331.49642487506117 523.5466927307273 A 15.832581659999999 15.832581659999999 0 0 1 347.3290065350612 507.71411107072726 L 576.5027951850611 507.71411107072726 L 576.5027951850611 507.71411107072726 A 15.832581659999999 15.832581659999999 0 0 1 592.3353768450611 523.5466927307273 L 592.3353768450611 549.9343288307273 L 592.3353768450611 549.9343288307273 A 15.832581659999999 15.832581659999999 0 0 1 576.5027951850611 565.7669104907272 L 347.3290065350612 565.7669104907272 L 347.3290065350612 565.7669104907272 A 15.832581659999999 15.832581659999999 0 0 1 331.49642487506117 549.9343288307273 L 331.49642487506117 523.5466927307273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="356.12488523506113" y="532.3425714307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drmMalloc( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="356.12488523506113" y="549.9343288307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">// 分配 </text><text fill="purple" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="406.6474377252955" y="549.9343288307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">dmModeAtomicReqPtr</text></g><g><g><rect fill="white" stroke="none" x="99.38343452293877" y="592.1545465907273" width="166.33700597976562" height="22.86928462"/></g><text fill="purple" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="102.02219813293877" y="607.9871282507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">dmModeAtomicReqPtr</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 322.70054617506116 615.0238312107273 L 44.60229852558203 615.0238312107273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(42.40332885058203,615.0238312107273) translate(-42.40332885058203,-615.0238312107273)"><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 57.475130493870985 608.3001723800559 L 44.05134409040454 615.0238312107273 L 57.475130493870985 621.7474900413987" stroke-miterlimit="10" stroke-width="1.4659797833333332"/></g></g><g><g><rect fill="white" stroke="none" x="68.10569404442315" y="641.4114673107273" width="228.89248693679687" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="70.74445765442314" y="657.2440489707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drmModeAtomicAddProperty( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 42.40332885058203 664.2807519307273 L 308.21666591572784 664.2807519307273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(322.70054617506116,664.2807519307273) translate(-322.70054617506116,-664.2807519307273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 308.0407483417278 656.9508530140606 L 322.70054617506116 664.2807519307273 L 308.0407483417278 671.610650847394 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 322.70054617506116 710.8989090407273 L 331.49642487506117 710.8989090407273 M 331.49642487506117 706.5009696907272 L 331.49642487506117 706.5009696907272 A 15.832581659999999 15.832581659999999 0 0 1 347.3290065350612 690.6683880307272 L 580.124819721194 690.6683880307272 L 580.124819721194 690.6683880307272 A 15.832581659999999 15.832581659999999 0 0 1 595.9574013811939 706.5009696907272 L 595.9574013811939 715.2968483907273 L 595.9574013811939 715.2968483907273 A 15.832581659999999 15.832581659999999 0 0 1 580.124819721194 731.1294300507273 L 347.3290065350612 731.1294300507273 L 347.3290065350612 731.1294300507273 A 15.832581659999999 15.832581659999999 0 0 1 331.49642487506117 715.2968483907273 L 331.49642487506117 706.5009696907272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="356.12488523506113" y="715.2968483907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">save to </text><text fill="purple" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="410.2694622614283" y="715.2968483907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">dmModeAtomicReqPtr</text></g><g><g><rect fill="white" stroke="none" x="69.79504798729424" y="757.5170661507273" width="225.51377905105468" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="72.43381159729424" y="773.3496478107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drmModeAtomicCommit()        </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 42.40332885058203 780.3863507707273 L 308.21666591572784 780.3863507707273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(322.70054617506116,780.3863507707273) translate(-322.70054617506116,-780.3863507707273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 308.0407483417278 773.0564518540606 L 322.70054617506116 780.3863507707273 L 308.0407483417278 787.716249687394 Z"/></g></g><g><g><rect fill="white" stroke="none" x="343.51745909839445" y="806.7739868707273" width="244.31843603347656" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="346.15622270839447" y="822.6065685307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">iotcl(</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="380.7804292513632" y="822.6065685307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">DRM_IOCTL_MODE_ATOMIC</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="580.3009218050742" y="822.6065685307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 322.70054617506116 829.6432714907273 L 594.168927795871 829.6432714907273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(608.6528080552043,829.6432714907273) translate(-608.6528080552043,-829.6432714907273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 593.993010221871 822.3133725740606 L 608.6528080552043 829.6432714907273 L 593.993010221871 836.973170407394 Z"/></g></g><g><g><rect fill="white" stroke="none" x="786.8005127166301" y="856.0309075907273" width="186.24394262527343" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="789.4392763266301" y="871.8634892507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_mode_atomic_ioctl( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 608.6528080552043 878.9001922107274 L 1136.708279743996 878.9001922107274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1151.1921600033293,878.9001922107274) translate(-1151.1921600033293,-878.9001922107274)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1136.5323621699958 871.5702932940607 L 1151.1921600033293 878.9001922107274 L 1136.5323621699958 886.2300911273941 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1172.0173014933682" y="905.2878283107274" width="511.81962621902346" height="22.86928462"/></g><g><rect fill="white" stroke="none" x="1172.0173014933682" y="922.8795857107274" width="175.04849279617187" height="22.86928462"/></g><g><rect fill="yellow" stroke="none" x="1174.6560651033683" y="908.1025094947273" width="176.86473083496094" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1174.6560651033683" y="921.1204099707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_state_alloc( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1351.5207959383292" y="921.1204099707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                                                            </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1174.6560651033683" y="938.7121673707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//分配 drm_atomic_state</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 945.7488703307274 L 1690.1781889430974 945.7488703307274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1704.6620692024308,945.7488703307274) translate(-1704.6620692024308,-945.7488703307274)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1690.0022713690973 938.4189714140607 L 1704.6620692024308 945.7488703307274 L 1690.0022713690973 953.0787692473941 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1704.6620692024308 1062.7340570407273 L 1695.8661905024308 1062.7340570407273 M 1159.9880387033293 987.9690880907274 L 1159.9880387033293 987.9690880907274 A 15.832581659999999 15.832581659999999 0 0 1 1175.8206203633292 972.1365064307274 L 1680.033608842431 972.1365064307274 L 1680.033608842431 972.1365064307274 A 15.832581659999999 15.832581659999999 0 0 1 1695.866190502431 987.9690880907274 L 1695.866190502431 1137.4990259907274 L 1695.866190502431 1137.4990259907274 A 15.832581659999999 15.832581659999999 0 0 1 1680.033608842431 1153.3316076507274 L 1175.8206203633292 1153.3316076507274 L 1175.8206203633292 1153.3316076507274 A 15.832581659999999 15.832581659999999 0 0 1 1159.9880387033293 1137.4990259907274 L 1159.9880387033293 987.9690880907274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="996.7649667907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if  no NULL</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1014.3567241907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1206.3057996004386" y="1014.3567241907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">config-&gt;funcs-&gt;atomic_state_alloc( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1031.9484815907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      //drm_mode_config_funcs中设定</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1067.1319963907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    </text><g><rect fill="#FFCCFF" stroke="none" x="1201.9679394930167" y="1054.1140959147272" width="14.917678833007812" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1201.9679394930167" y="1067.1319963907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1084.7237537907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      kzalloc(sizeof(drm_atomic_state))</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1102.3155111907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      </text><text fill="green" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1210.6436597078605" y="1102.3155111907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_state_init</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1363.0989361971183" y="1102.3155111907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1119.9072685907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">             1. kcalloc(num*sizeof(</text><text fill="purple" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1393.6643811434074" y="1119.9072685907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">__drm_crtcs_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1515.4396344393058" y="1119.9072685907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">))    --&gt; state-&gt;crtcs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1137.4990259907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">             2. kcalloc(num*sizeof(</text><text fill="purple" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1393.6643811434074" y="1137.4990259907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">__drm_planes_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1528.1454144686027" y="1137.4990259907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">))  --&gt; state-&gt;planes</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 1349.4797026607273 L 1159.9880387033293 1349.4797026607273 M 1159.9880387033293 1195.5518254107274 L 1159.9880387033293 1195.5518254107274 A 15.832581659999999 15.832581659999999 0 0 1 1175.8206203633292 1179.7192437507274 L 1568.1654447799308 1179.7192437507274 L 1568.1654447799308 1179.7192437507274 A 15.832581659999999 15.832581659999999 0 0 1 1583.9980264399308 1195.5518254107274 L 1583.9980264399308 1503.4075799107275 L 1583.9980264399308 1503.4075799107275 A 15.832581659999999 15.832581659999999 0 0 1 1568.1654447799308 1519.2401615707274 L 1175.8206203633292 1519.2401615707274 L 1175.8206203633292 1519.2401615707274 A 15.832581659999999 15.832581659999999 0 0 1 1159.9880387033293 1503.4075799107275 L 1159.9880387033293 1195.5518254107274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><g><rect fill="yellow" stroke="none" x="1184.6164990633292" y="1191.329803634727" width="374.7530212402344" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1204.3477041107271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//保存各种property到对应crtc, connector, plane的state</text><g><rect fill="yellow" stroke="none" x="1184.6164990633292" y="1208.9215610347271" width="178.47532653808594" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1221.9394615107271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//对应state可能是新分配的</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1257.1229763107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">for each obj</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1274.7147337107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  for each prop</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1292.3064911107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     drm_atomic_set_property( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1327.4900059107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">           case connector:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1345.0817633107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_get_connector_state()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1362.6735207107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_connector_set_property()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1397.8570355107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">           case crtc</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1415.4487929107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_get_crtc_state( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1433.0405503107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_crtc_set_property( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1468.2240651107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">           case plane</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1485.8158225107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_get_plane_state( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="1503.4075799107272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_plane_set_property( )</text></g><g><g><rect fill="white" stroke="none" x="1229.2039775187588" y="1593.1255426507275" width="397.4462741682422" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1231.842741128759" y="1608.9581243107275" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_get_connector_state( )                                  </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 1615.9948272707275 L 1690.1781889430974 1615.9948272707275" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1704.6620692024308,1615.9948272707275) translate(-1704.6620692024308,-1615.9948272707275)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1690.0022713690973 1608.6649283540607 L 1704.6620692024308 1615.9948272707275 L 1690.0022713690973 1623.3247261873942 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1704.6620692024308 1741.7758926807273 L 1695.8661905024308 1741.7758926807273 M 1254.955720588095 1658.2150450307274 L 1254.955720588095 1658.2150450307274 A 15.832581659999999 15.832581659999999 0 0 1 1270.7883022480949 1642.3824633707275 L 1680.0336088424308 1642.3824633707275 L 1680.0336088424308 1642.3824633707275 A 15.832581659999999 15.832581659999999 0 0 1 1695.8661905024308 1658.2150450307274 L 1695.8661905024308 1825.3367403307275 L 1695.8661905024308 1825.3367403307275 A 15.832581659999999 15.832581659999999 0 0 1 1680.0336088424308 1841.1693219907274 L 1270.7883022480949 1841.1693219907274 L 1270.7883022480949 1841.1693219907274 A 15.832581659999999 15.832581659999999 0 0 1 1254.955720588095 1825.3367403307275 L 1254.955720588095 1658.2150450307274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1279.5841809480949" y="1667.0109237307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">connector-&gt;funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1420.972898599462" y="1667.0109237307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_duplicate_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1580.5648785799308" y="1667.0109237307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(connector);</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1279.5841809480949" y="1684.6026811307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//得到new connector_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1279.5841809480949" y="1719.7861959307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">// state是在</text><text fill="green" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1359.7774487703605" y="1719.7861959307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_state_init</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1512.2327252596183" y="1719.7861959307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">()中分配</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1279.5841809480949" y="1737.3779533307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> state-&gt;connectors[index].</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1464.0866986482902" y="1737.3779533307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">old_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1527.2649365633292" y="1737.3779533307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> = connector-&gt;state;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1279.5841809480949" y="1754.9697107307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> state-&gt;connectors[index].</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1464.0866986482902" y="1754.9697107307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">new_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1533.592786905126" y="1754.9697107307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> = connector_state;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1279.5841809480949" y="1772.5614681307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> state-&gt;connectors[index].ptr = connector;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1279.5841809480949" y="1790.1532255307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> connector_state-&gt;state = state;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1279.5841809480949" y="1825.3367403307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return new </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1359.992200967626" y="1825.3367403307273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">connector_state</text></g><g><g><rect fill="white" stroke="none" x="1232.9404429728604" y="1867.5569580907274" width="389.9733432600391" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1235.5792065828605" y="1883.3895397507274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_connector_set_property( </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1499.795423623876" y="1883.3895397507274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">connector_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1611.0409527986808" y="1883.3895397507274" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 1890.4262427107274 L 1690.1781889430974 1890.4262427107274" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1704.6620692024308,1890.4262427107274) translate(-1704.6620692024308,-1890.4262427107274)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1690.0022713690973 1883.0963437940607 L 1704.6620692024308 1890.4262427107274 L 1690.0022713690973 1897.756141627394 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1704.6620692024308 1972.2279146207272 L 1695.8661905024308 1972.2279146207272 M 1301.9277970041105 1932.6464604707273 L 1301.9277970041105 1932.6464604707273 A 15.832581659999999 15.832581659999999 0 0 1 1317.7603786641105 1916.8138788107274 L 1680.0336088424308 1916.8138788107274 L 1680.0336088424308 1916.8138788107274 A 15.832581659999999 15.832581659999999 0 0 1 1695.8661905024308 1932.6464604707273 L 1695.8661905024308 2011.8093687707274 L 1695.8661905024308 2011.8093687707274 A 15.832581659999999 15.832581659999999 0 0 1 1680.0336088424308 2027.6419504307273 L 1317.7603786641105 2027.6419504307273 L 1317.7603786641105 2027.6419504307273 A 15.832581659999999 15.832581659999999 0 0 1 1301.9277970041105 2011.8093687707274 L 1301.9277970041105 1932.6464604707273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1326.5562573641105" y="1941.442339170727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if property 内部定义</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1326.5562573641105" y="1959.0340965707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   设置</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1368.8898144930167" y="1959.0340965707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">connector_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1480.1353436678214" y="1959.0340965707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> 对应字段</text><g><rect fill="#FFCCFF" stroke="none" x="1326.5562573641105" y="1981.199710894727" width="14.917678833007812" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1326.5562573641105" y="1994.2176113707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1326.5562573641105" y="2011.8093687707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    调用connector-&gt;funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1514.6163922518058" y="2011.8093687707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_set_property</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1657.1074506014152" y="2011.8093687707271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text></g><g><g><rect fill="white" stroke="none" x="1253.3915309245206" y="2127.9149676107268" width="349.0711673567188" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1256.0302945345206" y="2143.7475492707267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_get_</text><text fill="purple" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1375.3359891145988" y="2143.7475492707267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">xxx</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1397.6266080110831" y="2143.7475492707267" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">_state( )                                  </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 2150.784252230727 L 1690.1781889430974 2150.784252230727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1704.6620692024308,2150.784252230727) translate(-1704.6620692024308,-2150.784252230727)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1690.0022713690973 2143.4543533140604 L 1704.6620692024308 2150.784252230727 L 1690.0022713690973 2158.1141511473934 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1259.6262492472745" y="2177.1718883307267" width="336.60173071121096" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1262.2650128572745" y="2193.0044699907266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_</text><text fill="purple" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1351.8427106111808" y="2193.0044699907266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">xxx</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1374.1333295076652" y="2193.0044699907266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">_set_property( </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1478.1061230867667" y="2193.0044699907266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">xxx_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1540.976545450048" y="2193.0044699907266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> )          </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 2200.041172950727 L 1690.1781889430974 2200.041172950727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1704.6620692024308,2200.041172950727) translate(-1704.6620692024308,-2200.041172950727)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1690.0022713690973 2192.7112740340604 L 1704.6620692024308 2200.041172950727 L 1690.0022713690973 2207.3710718673933 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 2361.0057531607267 L 1159.9880387033293 2361.0057531607267 M 1159.9880387033293 2268.6490268107264 L 1159.9880387033293 2268.6490268107264 A 15.832581659999999 15.832581659999999 0 0 1 1175.8206203633292 2252.8164451507264 L 1572.496087480126 2252.8164451507264 L 1572.496087480126 2252.8164451507264 A 15.832581659999999 15.832581659999999 0 0 1 1588.328669140126 2268.6490268107264 L 1588.328669140126 2453.3624795107266 L 1588.328669140126 2453.3624795107266 A 15.832581659999999 15.832581659999999 0 0 1 1572.496087480126 2469.1950611707266 L 1175.8206203633292 2469.1950611707266 L 1175.8206203633292 2469.1950611707266 A 15.832581659999999 15.832581659999999 0 0 1 1159.9880387033293 2453.3624795107266 L 1159.9880387033293 2268.6490268107264" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><g><rect fill="yellow" stroke="none" x="1184.6164990633292" y="2264.427005034727" width="138.15318298339844" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2277.4449055107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">prepare_signaling( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2295.0366629107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> //准备工作</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2330.2201777107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        for each crtc // </text><g><rect fill="#CCE5FF" stroke="none" x="1328.0094281404777" y="2317.202277234727" width="46.284912109375" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1328.0094281404777" y="2330.2201777107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TODO:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2347.8119351107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">             drm_crtc_create_fence()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2365.4036925107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">             setup_out_fence()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2382.9954499107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">            // 构建新fence， 把所有fence保存到 fence_state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2418.1789647107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">         for each connector </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2435.7707221107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">             // for writeback 回写连接器</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="2453.3624795107266" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">            </text></g><g><g><rect fill="white" stroke="none" x="1186.1797694499112" y="2495.5826972707264" width="483.4946903059375" height="22.86928462"/></g><g><rect fill="white" stroke="none" x="1186.1797694499112" y="2513.1744546707264" width="331.25468481277346" height="22.86928462"/></g><g><rect fill="yellow" stroke="none" x="1188.8185330599113" y="2498.3973784547265" width="143.08523559570312" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1188.8185330599113" y="2511.4152789307263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_commit</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1331.9037686556144" y="2511.4152789307263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )                                                                          </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1188.8185330599113" y="2529.0070363307264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    --&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1229.7276059358878" y="2529.0070363307264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">mode_config-&gt;funcs-&gt;atomic_commit</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1500.665411111669" y="2529.0070363307264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 2536.0437392907265 L 1690.1781889430974 2536.0437392907265" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(1704.6620692024308,2536.0437392907265) translate(-1704.6620692024308,-2536.0437392907265)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1690.0022713690973 2528.71384037406 L 1704.6620692024308 2536.0437392907265 L 1690.0022713690973 2543.373638207393 Z"/></g></g><g><g><rect fill="white" stroke="none" x="877.2837204192668" y="2562.4313753907263" width="5.27752722" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="879.9224840292668" y="2578.2639570507263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 2567.7089026107265 L 623.1063281789471 2601.955110951094" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(608.6528080552043,2602.8924174107265) rotate(-3.710418626717521,0,0) translate(-608.6528080552043,-2602.8924174107265)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 623.3126058885376 2595.56251849406 L 608.6528080552043 2602.8924174107265 L 623.3126058885376 2610.222316327393 Z"/><g transform="rotate(3.710418626717521,0,0)"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 608.6528080552043 3423.5479001207264 L 617.4486867552043 3423.5479001207264 M 617.4486867552043 2645.112635170726 L 617.4486867552043 2645.112635170726 A 15.832581659999999 15.832581659999999 0 0 1 633.2812684152043 2629.2800535107262 L 1126.5636996433295 2629.2800535107262 L 1126.5636996433295 2629.2800535107262 A 15.832581659999999 15.832581659999999 0 0 1 1142.3962813033295 2645.112635170726 L 1142.3962813033295 4201.9831650707265 L 1142.3962813033295 4201.9831650707265 A 15.832581659999999 15.832581659999999 0 0 1 1126.5636996433295 4217.8157467307265 L 633.2812684152043 4217.8157467307265 L 633.2812684152043 4217.8157467307265 A 15.832581659999999 15.832581659999999 0 0 1 617.4486867552043 4201.9831650707265 L 617.4486867552043 2645.112635170726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2653.908513870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//drm 提供的 mode_config </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="831.6691881308293" y="2653.908513870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_commit</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="939.5002885946965" y="2653.908513870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">实现</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2671.500271270726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//drm_atomic_helper.c</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2706.683786070726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_helper_commit( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2741.867300870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">if(state-&gt;async_update) // 异步更新</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2777.050815670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     </text><g><rect fill="lightgray" stroke="none" x="663.7664476523137" y="2764.0329151947262" width="260.916259765625" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.7664476523137" y="2777.050815670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_helper_prepare_planes( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2812.234330470726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">           for each new plane in state </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2829.826087870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                  if( plane-&gt;helper_funcs-&gt;prepare_fb no NULL)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2847.417845270726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                           </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="759.1993700155949" y="2847.417845270726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">plane-&gt;helper_funcs-&gt;prepare_fb( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2865.009602670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                   or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2882.601360070726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                            drm_gem_plane_helper_prepare_fb( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2900.193117470726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                   drm_atomic_set_fence_for_plane( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2935.376632270726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     </text><g><rect fill="lightgray" stroke="none" x="663.7664476523137" y="2922.3587317947263" width="253.91558837890625" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.7664476523137" y="2935.376632270726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_helper_async_commit( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2970.560147070726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        for each new plane in state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="2988.151904470726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">             if(plane-&gt;helper_funcs-&gt;atomic_async_update no NULL)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3005.743661870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                     </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="733.1722093710637" y="3005.743661870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">plane-&gt;helpr_funcs-&gt;atomic_async_update( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1049.979673970673" y="3005.743661870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3040.927176670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     </text><g><rect fill="lightgray" stroke="none" x="663.7664476523137" y="3027.9092761947263" width="261.9828186035156" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.7664476523137" y="3040.927176670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_helper_cleanup_planes( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3076.110691470726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">         for each new plane in state</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3093.702448870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">               </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="707.1450487265324" y="3093.702448870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">plane-&gt;help_funcs-&gt;cleanup_fb( )</text><text fill="green" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3128.885963670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="656.9948259482121" y="3128.885963670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  //同步更新</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3164.069478470726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     </text><g><rect fill="#CCFFE5" stroke="none" x="663.7664476523137" y="3151.0515779947264" width="253.843994140625" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.7664476523137" y="3164.069478470726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_helper_setup_commit( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3181.661235870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     //准备工作，以支持非阻塞提交</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3216.844750670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">              a. init_completion</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3234.436508070726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">              b. mode_config-&gt;help_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="920.3233629355168" y="3234.436508070726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_commit_setup( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3269.620022870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     </text><g><rect fill="#CCFFE5" stroke="none" x="663.7664476523137" y="3256.6021223947264" width="85.590576171875" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.7664476523137" y="3269.620022870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">INIT_WORK </text><g><rect fill="#CCFFE5" stroke="none" x="749.3570238241887" y="3256.6021223947264" width="94.50968933105469" height="17.767674974"/><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="749.3570238241887" y="3269.620022870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">commit_work</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="843.8667131552434" y="3269.620022870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> // 初始化工作项 线程执行commit_tail( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3304.803537670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     </text><g><rect fill="#CCFFE5" stroke="none" x="663.7664476523137" y="3291.7856371947264" width="260.916259765625" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.7664476523137" y="3304.803537670726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_helper_prepare_planes( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3339.987052470726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     if( block) </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3357.578809870726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">          drm_atomic_helper_wait_for_fences( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3375.170567270726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">          // 在drm_atomic_helper_prepare_planes()中设置的fence？</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3410.3540820707262" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     </text><g><rect fill="#CCFFE5" stroke="none" x="663.7664476523137" y="3397.3361815947264" width="231.20974731445312" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.7664476523137" y="3410.3540820707262" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">drm_atomic_helper_swap_state( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3445.5375968707262" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     if( nonblock)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3463.1293542707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">          </text><g><rect fill="#CCFFE5" stroke="none" x="685.455748189423" y="3450.1114537947265" width="344.1876220703125" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="685.455748189423" y="3463.1293542707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">queue_work(system_unbound_wq, commit_work)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3480.7211116707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">          //线程执行commit_tail()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3515.9046264707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3533.4963838707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">          </text><g><rect fill="#CCFFE5" stroke="none" x="685.455748189423" y="3520.4784833947265" width="95.57624816894531" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="685.455748189423" y="3533.4963838707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">commit_tail( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3551.0881412707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">            </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3568.6798986707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                //等待在old_state中先前提交的完成</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3586.2716560707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_helper_wait_for_fences( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3603.8634134707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_helper_wait_for_dependencies( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3621.4551708707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                      wait_for_completion_timeout() //crtc, connector, plane</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3656.6386856707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                if no null</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3674.2304430707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                     mode_config-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="947.3741441855168" y="3674.2304430707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_commit_tail()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3691.8222004707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3709.4139578707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                     drm_atomic_helper_commit_tail( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3727.0057152707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        1. drm_atomic_helper_commit_modeset_disables( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3744.5974726707263" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                            disable_output( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3762.1892300707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                encoder-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="960.0225511679387" y="3762.1892300707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_disable</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1064.0955644736027" y="3762.1892300707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3779.7809874707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                crtc-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="929.7147508749699" y="3779.7809874707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_disable</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1033.787764180634" y="3779.7809874707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3797.3727448707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3814.9645022707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        2. drm_atomic_helper_commit_planes( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3832.5562596707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                 crtc-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="934.0526109823918" y="3832.5562596707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_begin</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1028.3690172323918" y="3832.5562596707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3850.1480170707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                 plane-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="946.7583910116887" y="3850.1480170707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_update</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1050.6166673788762" y="3850.1480170707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3867.7397744707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                 crtc-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="934.0526109823918" y="3867.7397744707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_flush</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1022.2058092245793" y="3867.7397744707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3902.9232892707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        3. drm_atomic_helper_commit_modeset_enables( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3920.5150466707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                 crtc-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="934.0526109823918" y="3920.5150466707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_enable</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1035.4126726278996" y="3920.5150466707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3938.1068040707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                 encoder-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="964.3604112753605" y="3938.1068040707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">atomic_enable</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1065.7204729208684" y="3938.1068040707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3973.2903188707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        4. drm_atomic_helper_fake_vblank( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="3990.8820762707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                 drm_crtc_send_vblank_event( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="4026.0655910707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        5. drm_atomic_helper_commit_hw_done( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="4043.6573484707264" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                 complete_all(hw_done)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="4078.8408632707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        6. drm_atomic_helper_wait_for_vblanks( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="4096.4326206707265" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                  wait_event_timeout()</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="4131.616135470726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                        7. drm_atomic_helper_cleanup_planes( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="4149.207892870725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                  plane-&gt;helper_funcs-&gt;</text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="951.0962511191105" y="4149.207892870725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">cleanup_fb</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1027.3525072226262" y="4149.207892870725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="4184.391407670724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                drm_atomic_helper_commit_cleanup_done( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.0771471152043" y="4201.983165070724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                 </text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1151.1921600033293 4334.800933440726 L 1159.9880387033293 4334.800933440726 M 1159.9880387033293 4260.035964490727 L 1159.9880387033293 4260.035964490727 A 15.832581659999999 15.832581659999999 0 0 1 1175.8206203633292 4244.203382830727 L 1660.8711637740716 4244.203382830727 L 1660.8711637740716 4244.203382830727 A 15.832581659999999 15.832581659999999 0 0 1 1676.7037454340716 4260.035964490727 L 1676.7037454340716 4409.5659023907265 L 1676.7037454340716 4409.5659023907265 A 15.832581659999999 15.832581659999999 0 0 1 1660.8711637740716 4425.398484050726 L 1175.8206203633292 4425.398484050726 L 1175.8206203633292 4425.398484050726 A 15.832581659999999 15.832581659999999 0 0 1 1159.9880387033293 4409.5659023907265 L 1159.9880387033293 4260.035964490727" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><g><rect fill="yellow" stroke="none" x="1184.6164990633292" y="4255.813942714727" width="135.63351440429688" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="4268.831843190726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">complete_signaling</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1320.250013467626" y="4268.831843190726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="4286.423600590726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//善后工作</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="4321.607115390725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     if atomic_commit() 成功</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="4339.198872790725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">             --&gt; fd_install(fence_state[i].fd, fence_state[i].sync_file-&gt;file)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="4374.382387590724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="4391.974144990723" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">          fput(fence_state[i].fd)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1184.6164990633292" y="4409.565902390723" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">          put_unused_fd(fence_state[i].sync_file-&gt;file);</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1089.6210091033292 1545.6277976707274 L 1766.2332201024308 1545.6277976707274 L 1766.2332201024308 2054.029586530727 L 1089.6210091033292 2054.029586530727 L 1089.6210091033292 1545.6277976707274 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1089.6210091033292 1545.6277976707274 L 1089.6210091033292 1566.7379065507275 L 1184.147480446298 1566.7379065507275 L 1194.702534886298 1556.1828521107275 L 1194.702534886298 1545.6277976707274 L 1089.6210091033292 1545.6277976707274" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1107.2127665033292" y="1559.7012035907276" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">connector</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1089.6210091033292 2080.417222630727 L 1766.2332201024308 2080.417222630727 L 1766.2332201024308 2226.4288090507266 L 1089.6210091033292 2226.4288090507266 L 1089.6210091033292 2080.417222630727 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1089.6210091033292 2080.417222630727 L 1089.6210091033292 2101.527331510727 L 1304.5230602802824 2101.527331510727 L 1315.0781147202824 2090.9722770707267 L 1315.0781147202824 2080.417222630727 L 1089.6210091033292 2080.417222630727" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1107.2127665033292" y="2094.490628550727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">crtc plane 与connector相似操作</text></g></g><g/><g/><g/><g/><g/></g></g></g></g></g></g></g></g></g></g></g></g></g></g></g></g></g></g></g></g></svg>