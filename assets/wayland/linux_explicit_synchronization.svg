<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="721" height="1091"><desc>title%20linux_explicit_synchronization%0A%0Aclient%20-%3Elibweston%3Awl_registry_bind(%5Cn%20%20%20%20%20%20%3Ccolor%3A%23red%3Ezwp_linux_explicit_synchronization_v1_interface%3C%2Fcolor%3E)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%3Cbackground%3A%23yellow%3E1.%E7%BB%91%E5%AE%9A%E6%98%BE%E7%A4%BA%E5%90%8C%E6%AD%A5%E5%AF%B9%E8%B1%A1%3C%2Fbackground%3E%0Aclient-%3Elibweston%3Azwp_linux_explicit_synchronization_v1_get_synchronization(%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20expliciti_sync%2C%20%20surface)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%3Cbackground%3A%23yellow%3E2.%E9%92%88%E5%AF%B9surface%E5%88%9B%E5%BB%BAsync%E5%AF%B9%E8%B1%A1%3C%2Fbackground%3E%0Abox%20right%20of%20client%3A%3Cbackground%3A%23yellow%3Eegl%20%5C-%3E%20sync%20%5C-%3Efence_fd%20%3C%2Fbackground%3E%5Cn%5Cn1.eglCreateSyncKHR()%20%5C-%5C-%3E%20sync%5Cn2.eglDupNativeFenceFDANDROID(sync)%20%5C-%5C-%3E%20fence_fd%5Cn3.eglDestroySyncKHR(sync)%0Aclient-%3Elibweston%3Azwp_linux_surface_synchronization_v1_set_acquire_fence(fence_fd)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%3Cbackground%3A%23yellow%3E3.%E4%B8%BAsurface_sync%E5%AF%B9%E8%B1%A1%E8%AE%BE%E7%BD%AEfence_fd%5Cn%20compositor%E5%B0%86%E4%BC%9A%E7%AD%89%E5%BE%85%E5%AE%83%E7%9A%84%E5%AE%8C%E6%88%90%3C%2Fbackground%3E%0Aclient-%3Elibweston%3Azwp_linux_surface_synchronization_v1_get_release(surface_sync)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%3Cbackground%3A%23yellow%3E4.%E5%88%9B%E5%BB%BArelease%E5%AF%B9%E8%B1%A1%EF%BC%8C%E7%94%A8%E4%BA%8E%E7%9B%91%E5%90%ACserver%20callback%3C%2Fbackground%3E%0Aclient-%3Elibweston%3Azwp_linux_buffer_release_v1_add_listener(%20)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%3Cbackground%3A%23yellow%3E5.%E8%AE%BE%E7%BD%AE%E7%9B%91%E5%90%AC%E5%87%BD%E6%95%B0%3C%2Fbackground%3E%0Abox%20right%20of%20client%3Aconst%20struct%20zwp_linux_buffer_release_v1_listener%20%3D%20%7B%5Cn%20%20%20%20%20%20%20buffer_fenced_release%2C%5Cn%20%20%20%20%20%20%20buffer_immediate_release%2C%5Cn%7D%3B%5Cn%5Cn%E5%9C%A8buffer_fenced_release()%E5%B0%86%E4%BC%9A%E8%BF%94%E5%9B%9E%E9%9C%80%E8%A6%81Client%20%E7%AD%89%E5%BE%85%E7%9A%84compositor%20%E5%88%9B%E5%BB%BA%E7%9A%84egl%20fence%5Cn%E8%80%8Cbuffer_immediate_release%20%E6%80%8E%E4%B8%8D%E5%8C%85%E5%90%AB%E8%AF%A5%E4%BF%A1%E6%81%AF%0Aclient-%3Elibweston%3Awl_surface_attach()%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cnwl_surface_commit()%5Cn%3Cbackground%3A%23yellow%3E6.%20%E6%8F%90%E4%BA%A4surface%EF%BC%8Ccompositor%E5%BC%80%E5%A7%8B%E5%90%88%E6%88%90%5Cn%E5%B9%B6%E9%80%9A%E8%BF%87callback%20%E8%BF%94%E5%9B%9E%E8%A6%81client%E7%AD%89%E5%BE%85%E7%9A%84fence_fd%3C%2Fbackground%3E%0Abox%20right%20of%20client%3Await_for_buffer_release_fence(%20)%5Cn%20%5C-%5C-%3EeglCreateSyncKHR(%20fence_fd%20)%20%5C-%3Esync%5Cn%20%5C-%5C-%3EeglWaitSyncKHR(sync)%5Cn%3Cbackground%3A%23yellow%3E7.Client%20%E7%AD%89%E5%BE%85%E4%B8%8A%E9%9D%A2callback%20%E8%BF%94%E5%9B%9E%E7%9A%84fence_fd%3C%2Fbackground%3E</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="721" height="1091"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 103.10369087072726 L 46.86647124560156 1091.7604567507271" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 659.491852246461 103.10369087072726 L 659.491852246461 1091.7604567507271" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.795878699999996 55.60594589072727 L 84.93706379120312 55.60594589072727 L 84.93706379120312 103.10369087072726 L 8.795878699999996 103.10369087072726 L 8.795878699999996 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="27.882935478999997" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 606.6753719445118 55.60594589072727 L 712.3083325484102 55.60594589072727 L 712.3083325484102 103.10369087072726 L 606.6753719445118 103.10369087072726 L 606.6753719445118 55.60594589072727 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="625.7624287235118" y="85.51193347072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">libweston</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="210.1277618408203" y="26.547561167272725" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">linux_explicit_synchronization</text></g><g><rect fill="white" stroke="none" x="75.71590472782812" y="138.28720567072725" width="123.69558752273437" height="22.86928462"/><rect fill="white" stroke="none" x="75.71590472782812" y="155.87896307072725" width="31.30468786453125" height="22.86928462"/><rect fill="white" stroke="none" x="75.71590472782812" y="155.87896307072725" width="337.4751590559375" height="22.86928462"/><rect fill="white" stroke="none" x="75.71590472782812" y="155.87896307072725" width="196.7017215559375" height="22.86928462"/><rect fill="white" stroke="none" x="75.71590472782812" y="173.47072047072726" width="134.68342626785156" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="78.35466833782812" y="154.11978733072726" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">wl_registry_bind(</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="78.35466833782812" y="171.71154473072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      </text><text fill="red" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="104.38182898235937" y="171.71154473072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">zwp_linux_explicit_synchronization_v1_interface</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="436.57946081829687" y="171.71154473072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)                                           </text><rect fill="yellow" stroke="none" x="78.35466833782812" y="176.28540165472728" width="129.40589904785156" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="78.35466833782812" y="189.30330213072727" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1.绑定显示同步对象</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 196.34000509072726 L 645.0079719871277 196.34000509072726" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(659.491852246461,196.34000509072726) translate(-659.491852246461,-196.34000509072726)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 644.8320544131277 189.01010617406058 L 659.491852246461 196.34000509072726 L 644.8320544131277 203.66990400739394 Z"/></g></g><g><rect fill="white" stroke="none" x="80.32238055790624" y="222.7276411907273" width="425.7214359114063" height="22.86928462"/><rect fill="white" stroke="none" x="80.32238055790624" y="240.3193985907273" width="545.7136844465625" height="22.86928462"/><rect fill="white" stroke="none" x="80.32238055790624" y="257.9111559907273" width="186.86666906570312" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.96114416790624" y="238.5602228507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">zwp_linux_explicit_synchronization_v1_get_synchronization( </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.96114416790624" y="256.1519802507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">                                        expliciti_sync,  surface)                                                </text><rect fill="yellow" stroke="none" x="82.96114416790624" y="260.7258371747273" width="181.58914184570312" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.96114416790624" y="273.7437376507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2.针对surface创建sync对象</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 280.7804406107273 L 645.0079719871277 280.7804406107273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(659.491852246461,280.7804406107273) translate(-659.491852246461,-280.7804406107273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 644.8320544131277 273.45054169406063 L 659.491852246461 280.7804406107273 L 644.8320544131277 288.11033952739393 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 362.58211252072726 L 55.66234994560156 362.58211252072726 M 55.66234994560156 307.1680767107273 L 475.3416797232187 307.1680767107273 L 475.3416797232187 417.9961483307273 L 55.66234994560156 417.9961483307273 L 55.66234994560156 307.1680767107273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><rect fill="yellow" stroke="none" x="80.29081030560155" y="318.7786365947273" width="163.443115234375" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="331.7965370707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">egl -&gt; sync -&gt;fence_fd </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="366.9800518707273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1.eglCreateSyncKHR() --&gt; sync</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="384.57180927072733" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2.eglDupNativeFenceFDANDROID(sync) --&gt; fence_fd</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="402.16356667072733" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3.eglDestroySyncKHR(sync)</text></g><g><rect fill="white" stroke="none" x="86.00212909306249" y="444.3837844307273" width="534.35418737625" height="22.86928462"/><rect fill="white" stroke="none" x="86.00212909306249" y="461.9755418307273" width="237.91178930496093" height="22.86928462"/><rect fill="white" stroke="none" x="86.00212909306249" y="479.5672992307273" width="206.931091673125" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="88.64089270306249" y="460.2163660907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">zwp_linux_surface_synchronization_v1_set_acquire_fence(fence_fd)               </text><rect fill="yellow" stroke="none" x="88.64089270306249" y="464.7902230147273" width="232.63426208496094" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="88.64089270306249" y="477.8081234907273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3.为surface_sync对象设置fence_fd</text><rect fill="yellow" stroke="none" x="88.64089270306249" y="482.3819804147273" width="201.653564453125" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="88.64089270306249" y="495.39988089072733" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> compositor将会等待它的完成</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 502.4365838507273 L 645.0079719871277 502.4365838507273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(659.491852246461,502.4365838507273) translate(-659.491852246461,-502.4365838507273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 644.8320544131277 495.10668493406064 L 659.491852246461 502.4365838507273 L 644.8320544131277 509.76648276739394 Z"/></g></g><g><rect fill="white" stroke="none" x="87.23690082157812" y="528.8242199507273" width="531.8845828840625" height="22.86928462"/><rect fill="white" stroke="none" x="87.23690082157812" y="546.4159773507273" width="301.519470579375" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="89.87566443157812" y="544.6568016107273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">zwp_linux_surface_synchronization_v1_get_release(surface_sync)                  </text><rect fill="yellow" stroke="none" x="89.87566443157812" y="549.2306585347272" width="296.241943359375" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="89.87566443157812" y="562.2485590107273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4.创建release对象，用于监听server callback</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 569.2852619707273 L 645.0079719871277 569.2852619707273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(659.491852246461,569.2852619707273) translate(-659.491852246461,-569.2852619707273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 644.8320544131277 561.9553630540606 L 659.491852246461 569.2852619707273 L 644.8320544131277 576.615160887394 Z"/></g></g><g><rect fill="white" stroke="none" x="89.44536639774999" y="595.6728980707272" width="527.4675906965625" height="22.86928462"/><rect fill="white" stroke="none" x="89.44536639774999" y="613.2646554707272" width="105.36344946121093" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="92.08413000774999" y="611.5054797307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">zwp_linux_buffer_release_v1_add_listener( )                                                   </text><rect fill="yellow" stroke="none" x="92.08413000774999" y="616.0793366547272" width="100.08592224121094" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="92.08413000774999" y="629.0972371307272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5.设置监听函数</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 636.1339400907273 L 645.0079719871277 636.1339400907273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(659.491852246461,636.1339400907273) translate(-659.491852246461,-636.1339400907273)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 644.8320544131277 628.8040411740606 L 659.491852246461 636.1339400907273 L 644.8320544131277 643.463839007394 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 735.5273694007273 L 55.66234994560156 735.5273694007273 M 55.66234994560156 662.5215761907273 L 650.695973546461 662.5215761907273 L 650.695973546461 808.5331626107272 L 55.66234994560156 808.5331626107272 L 55.66234994560156 662.5215761907273" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="687.1500365507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">const struct zwp_linux_buffer_release_v1_listener = {</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="704.7417939507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       buffer_fenced_release,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="722.3335513507272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       buffer_immediate_release,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="739.9253087507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">};</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="775.1088235507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">在buffer_fenced_release()将会返回需要Client 等待的compositor 创建的egl fence</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="792.7005809507273" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">而buffer_immediate_release 怎不包含该信息</text></g><g><rect fill="white" stroke="none" x="95.59795428837499" y="834.9207987107272" width="515.1624149153125" height="22.86928462"/><rect fill="white" stroke="none" x="95.59795428837499" y="852.5125561107272" width="147.7686160871875" height="22.86928462"/><rect fill="white" stroke="none" x="95.59795428837499" y="870.1043135107273" width="254.9697421858203" height="22.86928462"/><rect fill="white" stroke="none" x="95.59795428837499" y="887.6960709107273" width="294.5044559309375" height="22.86928462"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="98.23671789837499" y="850.7533803707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">wl_surface_attach()                                                                                       </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="98.23671789837499" y="868.3451377707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">wl_surface_commit()</text><rect fill="yellow" stroke="none" x="98.23671789837499" y="872.9189946947272" width="249.6922149658203" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="98.23671789837499" y="885.9368951707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. 提交surface，compositor开始合成</text><rect fill="yellow" stroke="none" x="98.23671789837499" y="890.5107520947272" width="289.2269287109375" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="98.23671789837499" y="903.5286525707272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">并通过callback 返回要client等待的fence_fd</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 910.5653555307272 L 645.0079719871277 910.5653555307272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(659.491852246461,910.5653555307272) translate(-659.491852246461,-910.5653555307272)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 644.8320544131277 903.2354566140605 L 659.491852246461 910.5653555307272 L 644.8320544131277 917.8952544473939 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 46.86647124560156 983.5711487407272 L 55.66234994560156 983.5711487407272 M 55.66234994560156 936.9529916307272 L 392.22784915681245 936.9529916307272 L 392.22784915681245 1030.1893058507271 L 55.66234994560156 1030.1893058507271 L 55.66234994560156 936.9529916307272" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="961.5814519907271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">wait_for_buffer_release_fence( )</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="979.1732093907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> --&gt;eglCreateSyncKHR( fence_fd ) -&gt;sync</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="996.7649667907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> --&gt;eglWaitSyncKHR(sync)</text><rect fill="yellow" stroke="none" x="80.29081030560155" y="1001.3388237147271" width="278.8260803222656" height="17.767674974"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="80.29081030560155" y="1014.3567241907272" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7.Client 等待上面callback 返回的fence_fd</text></g></g><g/><g/></g></svg>